<!--pages/travelPlanShow/travelPlanShow.wxml-->

<view class="travel-plan-header-container">
  <view class="travel-plan-title">
    {{travelPlanName}}
  </view>
</view>

<view class="travel-plan-map-container">
  <map class="tencent-map" id="map"
    longitude="{{mapLongitude}}" latitude="{{mapLatitude}}" 
    markers="{{mapMarkers}}" show-location
    polyline="{{mapPolylines}}"
    bindtap="onMapTap"
    bindmarkertap="onMarkerTap"
    bindcallouttap="onCalloutTap">
    <cover-view slot="callout">
      <cover-view class="map-callout-bubble" 
        wx:for="{{mapMarkers}}" wx:key="unique"
        marker-id="{{item.id}}">
        <cover-view class="callout-bubble-title">
          <cover-view class="callout-bubble-title-text">{{item.name}}</cover-view>
          <cover-image class="callout-bubble-title-jmp-button" src="/images/jump-curv.png" />
        </cover-view>
        <cover-view class="callout-bubble-desc">
          {{item.desc}}
        </cover-view>
      </cover-view>
    </cover-view>
    <cover-image class="map-tool-button" src="/images/relocate.png" bindtap="onRelocateTap" />
  </map>
</view>

<view class="travel-plan-display-container">
  <van-steps
    steps="{{ steps }}"
    active="{{ stepActive }}"
    direction="vertical"
    textSlot descSlot 
    active-color="rgba(30, 144, 255, 1.0)" 
    bind:click-step="onClickStep">
    <view wx:for="{{steps}}" slot="text-{{index}}" wx:key="index"
      class="travel-plan-step-text">
      <view wx:if="{{item.type === 1}}" class="step-text-if">{{item.text}}</view>
      <view wx:else class="step-text-else"> 
        <view class="text-title">
          {{ stepType.type2Str(item.type) }} 
        </view>
        <image class="text-image"
          src="{{stepType.type2Img(item.type)}}">
        </image>
      </view>
    </view>
    <view wx:for="{{steps}}" slot="desc-{{index}}" wx:key="index"
      class="travel-plan-step-desc">
      <view class="desc-content">
        {{item.desc}}
      </view>
      <image wx:if="{{item.type === 3}}"
        class="desc-button"
        src="/images/nearby-hotel-reverse.png">
      </image>
    </view>
  </van-steps>
</view>

<view class="travel-plan-footer-container">
  <button class="travel-plan-delete-button" 
    hover-class="travel-plan-delete-button-hover"
    bindtap="onTapDelete">
    删除计划
  </button>
</view>

<wxs module="stepType">
function type2String(type) {
  var text = ""
  switch(type) {
    case 2: text = "交通"
      break
    case 3: text = "住宿"
      break
    default: 
  }
  return text
}

function type2Image(type) {
  var img_path = ""
  switch(type) {
    case 2: img_path = "/images/traffic.png"
      break
    case 3: img_path = "/images/rest.png"
      break
    default: 
  }
  return img_path
}

module.exports = {
  type2Str: type2String,
  type2Img: type2Image,
}
</wxs>